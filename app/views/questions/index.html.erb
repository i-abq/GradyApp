<div class="space-y-8">
  <div class="flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between">
    <div class="w-full flex-1">
      <%= form_with url: questions_path, method: :get, local: true, html: { class: "flex flex-col gap-4 rounded-lg border border-border bg-card p-4", data: { controller: "filters", filters_delay_value: 200 } } do |form| %>
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
          <div class="relative w-full md:max-w-sm lg:max-w-md">
            <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-muted-foreground">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4">
                <circle cx="11" cy="11" r="8" />
                <path d="m21 21-3.5-3.5" />
              </svg>
            </span>
            <%= form.text_field :q, value: @filters[:q], placeholder: "Buscar por título", class: "input pl-9", data: { action: "input->filters#submit" } %>
          </div>
          <div class="flex flex-wrap items-center gap-2">
            <%= multi_filter_dropdown(
                  form,
                  param: :difficulty,
                  label: "Dificuldade",
                  options: @difficulty_options,
                  selected_values: @filters[:difficulty],
                  counts: @difficulty_counts,
                  all_label: "Todas"
                ) %>
            <%= single_filter_dropdown(form, :area, label: "Área", options: @area_options, current_value: @filters[:area], all_label: "Todas") %>
            <%= single_filter_dropdown(form, :theme, label: "Tema", options: @theme_options, current_value: @filters[:theme], all_label: "Todos") %>
          </div>
        </div>
        <div class="text-xs text-muted-foreground">
          <%= pluralize(@questions.size, "questão", "questões") %> encontradas
        </div>
      <% end %>
    </div>

    <div class="flex items-center gap-2 self-start">
      <%= button_tag "Configurar Prova", class: "btn btn-secondary btn-sm", type: :button %>
      <%= button_tag "Adicionar questão", class: "btn btn-primary btn-sm", type: :button %>
    </div>
  </div>

  <div class="overflow-x-auto">
    <div class="min-w-full lg:min-w-[720px]">
      <div class="<%= table_container_class %>">
        <table class="w-full border-collapse text-sm text-foreground">
          <thead class="bg-muted/40 text-xs uppercase tracking-wide text-foreground">
            <tr>
              <th scope="col" class="px-6 py-3 text-left font-semibold">ID</th>
              <th scope="col" class="px-6 py-3 text-left font-semibold">Título</th>
              <th scope="col" class="px-6 py-3 text-left font-semibold">Dificuldade</th>
              <th scope="col" class="px-6 py-3 text-left font-semibold">Área</th>
              <th scope="col" class="px-6 py-3 text-left font-semibold">Tema</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-border">
            <% if @questions.any? %>
              <% @questions.each do |question| %>
                <tr class="transition-colors hover:bg-muted/30">
                  <td class="px-6 py-4 font-medium"><%= question[:id] %></td>
                  <td class="px-6 py-4"><%= question[:title] %></td>
                  <td class="px-6 py-4">
                    <span class="<%= difficulty_badge_class(question[:difficulty]) %>"><%= difficulty_label(question[:difficulty]) %></span>
                  </td>
                  <td class="px-6 py-4"><%= question[:area] %></td>
                  <td class="px-6 py-4"><%= question[:theme] %></td>
                </tr>
              <% end %>
            <% else %>
              <tr>
                <td colspan="5" class="px-6 py-10 text-center text-sm text-muted-foreground">
                  Nenhuma questão encontrada com os filtros selecionados.
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
